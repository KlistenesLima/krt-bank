{
  "dashboard": {
    "id": null,
    "uid": "krt-bank-overview",
    "title": "KRT Bank - Overview",
    "tags": ["krt-bank"],
    "timezone": "browser",
    "refresh": "30s",
    "time": { "from": "now-1h", "to": "now" },
    "panels": [
      {
        "id": 1, "type": "stat", "title": "Requests/sec",
        "gridPos": { "h": 4, "w": 6, "x": 0, "y": 0 },
        "targets": [{ "expr": "sum(rate(http_requests_total[5m]))", "legendFormat": "req/s" }],
        "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{ "value": 0, "color": "green" }, { "value": 100, "color": "yellow" }, { "value": 500, "color": "red" }] } } }
      },
      {
        "id": 2, "type": "stat", "title": "Error Rate",
        "gridPos": { "h": 4, "w": 6, "x": 6, "y": 0 },
        "targets": [{ "expr": "sum(rate(http_requests_total{status=~\"5..\"}[5m])) / sum(rate(http_requests_total[5m])) * 100", "legendFormat": "%" }],
        "fieldConfig": { "defaults": { "unit": "percent", "thresholds": { "steps": [{ "value": 0, "color": "green" }, { "value": 1, "color": "yellow" }, { "value": 5, "color": "red" }] } } }
      },
      {
        "id": 3, "type": "stat", "title": "P95 Latency",
        "gridPos": { "h": 4, "w": 6, "x": 12, "y": 0 },
        "targets": [{ "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[5m])) by (le))", "legendFormat": "p95" }],
        "fieldConfig": { "defaults": { "unit": "s", "thresholds": { "steps": [{ "value": 0, "color": "green" }, { "value": 0.5, "color": "yellow" }, { "value": 2, "color": "red" }] } } }
      },
      {
        "id": 4, "type": "stat", "title": "Active Services",
        "gridPos": { "h": 4, "w": 6, "x": 18, "y": 0 },
        "targets": [{ "expr": "count(up == 1)", "legendFormat": "services" }],
        "fieldConfig": { "defaults": { "thresholds": { "steps": [{ "value": 0, "color": "red" }, { "value": 2, "color": "yellow" }, { "value": 3, "color": "green" }] } } }
      },
      {
        "id": 5, "type": "timeseries", "title": "Requests por Servico",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 4 },
        "targets": [{ "expr": "sum(rate(http_requests_total[5m])) by (service)", "legendFormat": "{{ service }}" }]
      },
      {
        "id": 6, "type": "timeseries", "title": "Latencia por Endpoint (P95)",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 4 },
        "targets": [{ "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket[5m])) by (le, handler))", "legendFormat": "{{ handler }}" }]
      },
      {
        "id": 7, "type": "timeseries", "title": "Memoria por Servico",
        "gridPos": { "h": 8, "w": 12, "x": 0, "y": 12 },
        "targets": [{ "expr": "process_resident_memory_bytes / 1024 / 1024", "legendFormat": "{{ service }} (MB)" }],
        "fieldConfig": { "defaults": { "unit": "decmbytes" } }
      },
      {
        "id": 8, "type": "timeseries", "title": "HTTP Status Codes",
        "gridPos": { "h": 8, "w": 12, "x": 12, "y": 12 },
        "targets": [
          { "expr": "sum(rate(http_requests_total{status=~\"2..\"}[5m]))", "legendFormat": "2xx Success" },
          { "expr": "sum(rate(http_requests_total{status=~\"4..\"}[5m]))", "legendFormat": "4xx Client Error" },
          { "expr": "sum(rate(http_requests_total{status=~\"5..\"}[5m]))", "legendFormat": "5xx Server Error" }
        ]
      }
    ]
  }
}